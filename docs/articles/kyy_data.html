<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using hydroscoper to get stations’ and time-series’ data • hydroscoper</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">hydroscoper</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/kyy_data.html">Using hydroscoper to get stations' and time-series' data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kvantas/hydroscoper">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Using hydroscoper to get stations’ and time-series’ data</h1>
                        <h4 class="author">Konstantinos Vantas</h4>
            
            <h4 class="date">2018-01-06</h4>
          </div>

    
    
<div class="contents">
<section id="introduction" class="level1"><h1>Introduction</h1>
<p>This vignette shows how to create a tidy dataframe for the stations’ and time series’ data from Hydroscope. The subdomain of Hydroscope that we will apply the package’s functions is <a href="http:/kyy.hydroscope.gr" class="uri">http:/kyy.hydroscope.gr</a> (Ministry of Environment and Energy).</p>
<section id="get-database-values" class="level2"><h2>Get database values</h2>
<p>The following code shows how to download the data from kyy to a list.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># load libraries</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(hydroscoper)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># get data from kyy</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">kyy_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_functions.html">get_database</a></span>(<span class="st">"kyy"</span>)</a></code></pre></div>
</section></section><section id="stations-data" class="level1"><h1>Stations data</h1>
<section id="coordinates" class="level2"><h2>Coordinates</h2>
<p>To create a data frame with the stations latitude and longitude we use the <code>get_coords</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">coords &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_coords.html">get_coords</a></span>(kyy_data<span class="op">$</span>stations<span class="op">$</span>point)</a></code></pre></div>
</section><section id="names-translations" class="level2"><h2>Names translations</h2>
<p>Next, we will create meaningful names for the stations data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># create names data frames</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">wbas_names &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="dt">x =</span> kyy_data<span class="op">$</span>stations<span class="op">$</span>water_basin,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                  <span class="dt">y =</span> kyy_data<span class="op">$</span>water_basins[<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>)],</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                  <span class="dt">all.x =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                  <span class="dt">by.x =</span> <span class="st">"water_basin"</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                  <span class="dt">by.y =</span> <span class="st">"id"</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">wd_names &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="dt">x =</span> kyy_data<span class="op">$</span>stations<span class="op">$</span>water_division,</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">                  <span class="dt">y =</span> kyy_data<span class="op">$</span>water_divisions[<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>)],</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">                  <span class="dt">all.x =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">                  <span class="dt">by.x =</span> <span class="st">"water_division"</span>,</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">                  <span class="dt">by.y =</span> <span class="st">"id"</span>)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">own_names &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="dt">x =</span> kyy_data<span class="op">$</span>stations<span class="op">$</span>owner,</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">                   <span class="dt">y =</span> kyy_data<span class="op">$</span>owners[<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>)],</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">                    <span class="dt">all.x =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">                  <span class="dt">by.x =</span> <span class="st">"owner"</span>,</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">                  <span class="dt">by.y =</span> <span class="st">"id"</span>)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17"></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co"># transate names</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co"># own_names$name &lt;- hydro_translate(own_names$name, "owner")</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co"># wd_names$name &lt;- hydro_translate(wd_names$name, "division")</span></a></code></pre></div>
</section><section id="stations-data-frame" class="level2"><h2>Stations’ data frame</h2>
<p>Finally, we will create a tidy data frame with the stations values:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">stations &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="st">"station_id"</span> =<span class="st"> </span><span class="kw">as.numeric</span>(kyy_data<span class="op">$</span>stations<span class="op">$</span>id),</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  <span class="st">"name"</span> =<span class="st"> </span><span class="kw">as.character</span>(kyy_data<span class="op">$</span>stations<span class="op">$</span>name),</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="st">"water_basin"</span> =<span class="st"> </span><span class="kw">as.character</span>(wbas_names<span class="op">$</span>name),</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  <span class="st">"water_division"</span> =<span class="st"> </span><span class="kw">as.character</span>(wd_names<span class="op">$</span>name),</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  <span class="st">"owner"</span> =<span class="st"> </span><span class="kw">as.character</span>(own_names<span class="op">$</span>name),</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">  <span class="st">"longitude"</span> =<span class="st"> </span><span class="kw">as.numeric</span>(coords<span class="op">$</span>long),</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  <span class="st">"latitude"</span> =<span class="st"> </span><span class="kw">as.numeric</span>(coords<span class="op">$</span>lat),</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">  <span class="st">"altitude"</span> =<span class="st"> </span><span class="kw">as.numeric</span>(kyy_data<span class="op">$</span>stations<span class="op">$</span>altitude)</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">stations</a></code></pre></div>
</section></section><section id="timeseries" class="level1"><h1>Timeseries</h1>
<section id="names-and-terms-translation" class="level2"><h2>Names and terms translation</h2>
<p>We will create meaningful names for the time series’ data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># create names data frames</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">var_names &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="dt">x =</span> kyy_data<span class="op">$</span>timeseries<span class="op">$</span>variable,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                  <span class="dt">y =</span> kyy_data<span class="op">$</span>variables[<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"descr"</span>)],</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                  <span class="dt">all.x =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">                  <span class="dt">by.x =</span> <span class="st">"variable"</span>,</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">                  <span class="dt">by.y =</span> <span class="st">"id"</span>)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">ts_names &lt;-<span class="st">  </span><span class="kw">merge</span>(<span class="dt">x =</span> kyy_data<span class="op">$</span>timeseries<span class="op">$</span>time_step,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">                  <span class="dt">y =</span> kyy_data<span class="op">$</span>time_steps[<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"descr"</span>)],</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">                  <span class="dt">all.x =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">                  <span class="dt">by.x =</span> <span class="st">"time_step"</span>,</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">                  <span class="dt">by.y =</span> <span class="st">"id"</span>)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">ts_units &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="dt">x =</span> kyy_data<span class="op">$</span>timeseries<span class="op">$</span>unit_of_measurement,</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">                  <span class="dt">y =</span> kyy_data<span class="op">$</span>units[<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"symbol"</span>)],</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">                  <span class="dt">all.x =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">                  <span class="dt">by.x =</span> <span class="st">"unit_of_measurement"</span>,</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">                  <span class="dt">by.y =</span> <span class="st">"id"</span>)</a>
<a class="sourceLine" id="cb5-18" data-line-number="18"></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co"># translate names</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20">var_names<span class="op">$</span>descr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/hydro_translate.html">hydro_translate</a></span>(var_names<span class="op">$</span>descr, <span class="st">"variable"</span>)</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">ts_names<span class="op">$</span>descr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/hydro_translate.html">hydro_translate</a></span>(ts_names<span class="op">$</span>descr, <span class="st">"timestep"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">timeseries &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="st">"timeser_id"</span> =<span class="st"> </span><span class="kw">as.numeric</span>(kyy_data<span class="op">$</span>timeseries<span class="op">$</span>id),</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="st">"station_id"</span> =<span class="st"> </span><span class="kw">as.numeric</span>(kyy_data<span class="op">$</span>timeseries<span class="op">$</span>gentity),</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="st">"variable"</span> =<span class="st"> </span><span class="kw">as.character</span>(var_names<span class="op">$</span>descr),</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="st">"timestep"</span> =<span class="st"> </span><span class="kw">as.character</span>(ts_names<span class="op">$</span>descr),</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="st">"units"</span> =<span class="st"> </span><span class="kw">as.character</span>(ts_units<span class="op">$</span>symbol),</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  <span class="st">"start_date"</span> =<span class="st"> </span><span class="kw">as.character</span>(kyy_data<span class="op">$</span>timeseries<span class="op">$</span>start_date_utc),</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="st">"end_date"</span> =<span class="st"> </span><span class="kw">as.character</span>(kyy_data<span class="op">$</span>timeseries<span class="op">$</span>end_date_utc)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">timeseries</a></code></pre></div>
</section></section>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#get-database-values">Get database values</a></li>
      </ul>
</li>
      <li>
<a href="#stations-data">Stations data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#coordinates">Coordinates</a></li>
      <li><a href="#names-translations">Names translations</a></li>
      <li><a href="#stations-data-frame">Stations’ data frame</a></li>
      </ul>
</li>
      <li>
<a href="#timeseries">Timeseries</a><ul class="nav nav-pills nav-stacked">
<li><a href="#names-and-terms-translation">Names and terms translation</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Konstantinos Vantas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
